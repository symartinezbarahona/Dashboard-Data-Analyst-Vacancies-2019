---
title: "Data Dashboard For Data Analyst Jobs"
author: "Selvyn Yovany Martinez Barahona"
date: "5/21/2021"

---
title: "Data Dashboard For Data Analyst Jobs"
author: "Selvyn Yovany Martinez Barahona"
date: "5/10/2021"
output: pdf_document
---

```{R,echo= FALSE, include= FALSE}
getwd()
```

```{R, warning = FALSE, header = FALSE, message = FALSE, echo=FALSE }
data <- read.csv("2019_data_analyst_job.csv")  
library(ggplot2)
library("ggrepel")
library("randomcoloR")
library(tidyverse)
library(pander)
library(reshape2)
library (dplyr)
```

```{R, echo= FALSE, include= FALSE}
job_hired_apply <- data %>% # Summarizing data analyst titles by percent hired and percent easy apply
     group_by(job_title) %>% 
     summarize(job_hired = (sum(hired == "TRUE", na.rm=TRUE)/7002*100), 
                            job_apply =(sum(easy_apply == "TRUE", na.rm=TRUE)/5340*100))
job_hired_apply
```

```{R,echo= FALSE, include= FALSE}
pander_job_hired_apply <- data %>% 
     group_by(job_title) %>% # In order to add the percentage sign to the subsequent table, a different subset needed to be created. Adding a percentage sign converts numerical values to string values which makes working with the subset difficult. 
     summarize(job_hired = paste0(round(sum(hired == "TRUE", na.rm=TRUE)/7002*100, 2), "%"), 
  job_apply = paste0(round(sum(easy_apply == "TRUE", na.rm=TRUE)/5340*100,2), "%"))
pander_job_hired_apply
```

```{R,echo= FALSE}
colnames(pander_job_hired_apply) <- c("Data Analyst Title",
                               "Percent Hired", 
                               "Percent Easy Apply")
panderOptions('table.split.table', Inf) 
panderOptions('round',2)
pander(pander_job_hired_apply, 
caption = "Percent of Applicants Who Got Hired and Used Easy Apply By Data Analyst Title") 
``` 


```{R,echo= FALSE, include= FALSE}
n <-28
palette <- distinctColorPalette(28) #Colors are randomized for the sake of filling all values in the subsequent chart
```

```{R,echo= FALSE, include= FALSE}
job_hired_apply <- job_hired_apply %>% #The positions of the labels needed to be calculated so that the labels do not overlap when creating the pie chart
  mutate(csum = rev(cumsum(rev(job_hired))), 
         pos = job_hired/2 + lead(csum, 1),
         pos = if_else(is.na(pos), job_hired/2, pos))
```

```{R,echo= FALSE, include= FALSE}
job_hired_apply <- job_hired_apply %>% #A new column needed to be created in order to assign specific characters to our values. There was too much overlap in the values
  mutate(id=LETTERS[row_number()]) 
```

```{R,echo= FALSE, include= FALSE}
job_hired_apply$id <- 1:28 #Due to there only being 26 letters in the English Alphabet, numerical values needed to be assigned to then assign additional characters
```

```{R,echo= FALSE, include= FALSE}
job_hired_apply$id[c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28)] <- c("A", "B", "C","D","E", "F","G", "H","I", "J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X", "Y","Z","Za","Zb") #Values assigned
```

```{R, fig.width=80, fig.height=78,echo= FALSE, warning = FALSE}
job_plot <- ggplot(job_hired_apply, aes(x="", y= job_hired, fill= paste0(id, ': ' ,job_title, '- ',  round(job_hired,2),'%'))) +
  geom_bar(width = 1, stat = "identity")+ 
  geom_label_repel(aes(y=pos,label= id),size = 18, nudge_x = 1, show.legend = FALSE) +
  coord_polar("y", start=0)+
  theme_classic()+
  theme_void ()+
  theme(legend.position = "top",
       legend.title = element_text(size = 51),
       legend.text = element_text(size = 47))+
  theme(plot.title = element_text(size = 70, face = "bold"),
        plot.subtitle = element_text(size = 68),
        plot.caption = element_text(color = "blue", size = 68, face = "italic")) +
  scale_fill_manual(values =palette)+
  theme(axis.line = element_blank())+
  theme(axis.text = element_blank())+
  theme(axis.ticks = element_blank())+
  labs(x=NULL, y=NULL, fill= "Data Analyst Title") +
  labs (title="Percent Hired by Data Analyst Title")+
  labs (subtitle="Glassdoor 2019")+
  labs (caption= "Github.com/symartinezbarahona") 
job_plot
```

```{R,echo= FALSE, include= FALSE}
job_hired_apply <- job_hired_apply %>% #Label positions for percent easy apply needed to be calculated
  mutate(csum1 = rev(cumsum(rev(job_apply))), 
         pos_apply = job_apply/2 + lead(csum1, 1),
         pos_apply = if_else(is.na(pos_apply), job_apply/2, pos_apply))
```

```{R, fig.width=80, fig.height=78,echo= FALSE, warning = FALSE}
job_apply_plot <- ggplot(job_hired_apply, aes(x="", y= job_apply, fill= paste0(id, ': ' ,job_title, '- ',  round(job_apply,2),'%'))) +
  geom_bar(width = 1, stat = "identity")+ 
  geom_label_repel(aes(y=pos_apply,label= id),size = 18, nudge_x = 1, show.legend = FALSE) +
  coord_polar("y", start=0)+
  theme_classic()+
  theme_void ()+
  theme(legend.position = "top",
       legend.title = element_text(size = 51),
       legend.text = element_text(size = 47))+
  theme(plot.title = element_text(size = 70, face = "bold"),
        plot.subtitle = element_text(size = 68),
        plot.caption = element_text(color = "blue", size = 68, face = "italic")) +
  scale_fill_manual(values =palette)+
  theme(axis.line = element_blank())+
  theme(axis.text = element_blank())+
  theme(axis.ticks = element_blank())+
  labs(x=NULL, y=NULL, fill= "Data Analyst Title") +
  labs (title="Percent Easy Apply by Data Analyst Title")+
  labs (subtitle="Glassdoor 2019")+
  labs (caption= "Github.com/symartinezbarahona")
job_apply_plot
```